<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<title>EIP</title>
<link rel="stylesheet" href="common/css/style.css">
<link rel="stylesheet" href="source/eip.css">
<style>
	table {
		margin: 1em auto 0;
		width: 500px;
	}
		table tr {}
			table th,
			table td {
				border: solid #666 1px;
				padding: 10px;
			}

	input[type="text"], textarea {
		box-sizing: border-box;
		width: 100%;
	}
	textarea {
		height: 100px;
	}
	.favFood ul {
		list-style: circle;
		margin-left: 18px;
	}
		.favFood ul li {
			margin: 5px 0;
		}

	.submit {
		margin: 1em 0 0;
		text-align: center;
	}

</style>
<script src="common/js/jquery.js"></script>
<script src="source/eip.js"></script>
<script>
	EIP.addType('list', {
		getDefaultValue: function() {
			var list = this.$el.find('ul li').map(function() {
				return $(this).text();
			}).toArray();

			return JSON.stringify(list);
		},
		getFormValue: function() {
			var list = this.$input.find('input[type="text"]').map(function() {
				return $(this).val();
			}).toArray();

			return JSON.stringify(list);
		},
		renderHolder: function(val) {
			var arr = JSON.parse(val);
			var $ul, $el, html;

			if (arr.length) {
				$ul = $('<ul>');
				$el = $('<div>').append($ul);
				arr.forEach(function(item) {
					var $li = $('<li>').text(item);
					$ul.append($li);
				});
				html = $el.html();
			}
			else {
				html = this.$defaultLabel;
			}

			this.$holder.html(html);
		},
		renderForm: function(val) {
			if (!this.$input) {
				this.$input = $('<div>');
				this.$form.prepend(this.$input);
			}

			var arr = JSON.parse(val);
			var $input = this.$input.empty();
			arr.forEach(function(item) {
				var $i = $('<input type="text">').val(item);
				var $div = $('<div>').append($i);
				$input.append($div);
			});
		}
	});

	jQuery(function($) {
		$("div.eip").eip().bind('eip:submit', function(ev) {
			var $el = $(this);
			var eip = $el.data('eip');
			console.log(eip.typeName, $el.attr('data-eip-name'), $el.attr('data-eip-value'));
		});
	});
</script>
</head>
<body>

<p class="note"><a href="http://5509.me/log/skroll">Archive</a> | <a href="http://5509.me/">5509</a></p>
<div class="pagebody">
	<h1>Edit in place</h1>

	<p class="cap">鉛筆マークの箇所はクリックすると編集・選択できるようになります</p>
	<table>
		<colgroup>
			<col width=30%>
			<col width=70%>
		</colgroup>
		<tbody>
			<tr>
				<th>なまえ</th>
				<td>
					<div class="eip"
						data-eip-type="text"
						data-eip-name="name"
						data-eip-default="クリックして編集できます"
					>sample</div>
				</td>
			</tr>
			<tr>
				<th>趣味</th>
				<td>
					<div class="eip"
						data-eip-type="text"
						data-eip-name="hobby"
					>sample</div>
				</td>
			</tr>
			<tr>
				<th>セレクト(JSON)</th>
				<td>
					<div class="eip"
						data-eip-type="select"
						data-eip-name="json"
						data-eip-option="{&quot;A&quot;:&quot;data-A&quot;,&quot;B&quot;:&quot;data-B&quot;}"
					>data-B</div>
				</td>
			</tr>
			<tr>
				<th>セレクト(Array)</th>
				<td>
					<div class="eip"
						data-eip-type="select"
						data-eip-name="array"
						data-eip-option="[&quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;]"
					>C</div>
				</td>
			</tr>
			<tr>
				<th>自己紹介</th>
				<td>
					<div class="eip"
						data-eip-type="textarea"
						data-eip-name="introduce"
						data-eip-rows="10"
					>自己紹介がはいるよ<br>
&lt;strong&gt;タグがあった場合&lt;/strong&gt;は<em>どうなるかな</em></div>
				</td>
			</tr>
			<tr>
				<th>好きなもの</th>
				<td class="favFood">
					<div class="eip"
						data-eip-type="list"
						data-eip-name="favfood"
						>
						<ul>
							<li>ラーメン</li>
							<li>うどん</li>
						</ul>
					</div>
			</tr>
		</tbody>
	</table>
</div>
<p class="copy">Copyright &copy <a href="http://5509.me/">5509</a> Some Rights Reserved.</p>



</body>
</html>
